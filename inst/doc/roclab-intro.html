<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to roclab</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to roclab</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(roclab)</span></code></pre></div>
<div id="overview" class="section level1">
<h1>Overview</h1>
<p>The <strong>roclab</strong> package implements ROC-Optimizing Binary
Classifiers, supporting both linear and kernel models.</p>
<ul>
<li><strong>Linear models</strong> provide various regularization
penalties (ridge, lasso, alasso, elastic net, scad, mcp).</li>
<li><strong>Kernel models</strong> support flexible kernel functions
(radial, polynomial, linear, laplace).</li>
<li><strong>Both models</strong> include several surrogate loss
functions (hinge, hinge2 (squared hinge), logistic, exponential).</li>
</ul>
<p>For large-scale data, the model is computationally prohibitive
because its loss is a U-statistic involving a double summation. To
reduce this burden, the package adopts an efficient algorithm based on
an incomplete U-statistic, which approximates the loss with a single
summation. In kernel models, a Nyström low-rank approximation is further
applied to efficiently compute the kernel matrix. These approximations
substantially reduce computational cost and accelerate training, while
maintaining accuracy, making ROC-Optimizing Binary Classifiers practical
for large-scale datasets.</p>
<p>In addition, efficient optimization is performed using
<strong>Gradient Descent with the Adamax update rule</strong> —a variant
of Adam, based on the infinity norm—for linear models with the ridge
penalty and kernel models. For linear models with other penalties (i.e.,
those involving variable selection), <strong>Proximal Gradient Descent
with an Adamax adaptive learning rate scheme</strong> is employed.</p>
</div>
<div id="example-linear-model" class="section level1">
<h1>Example: Linear Model</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>n_lin_train <span class="ot">&lt;-</span> <span class="dv">1200</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>n_pos_lin <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fl">0.2</span> <span class="sc">*</span> n_lin_train )</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>n_neg_lin <span class="ot">&lt;-</span> n_lin_train  <span class="sc">-</span> n_pos_lin</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>X_train_lin <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">2</span> <span class="sc">*</span> n_neg_lin, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">2</span>),</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">2</span> <span class="sc">*</span> n_pos_lin, <span class="at">mean =</span>  <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>y_train_lin <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n_neg_lin), <span class="fu">rep</span>(<span class="dv">1</span>, n_pos_lin))</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co"># Fit a linear model</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>fit_lin <span class="ot">&lt;-</span> <span class="fu">roclearn</span>(X_train_lin, y_train_lin, <span class="at">lambda =</span> <span class="fl">0.1</span>)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="fu">summary</span>(fit_lin)</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt; Linear Model Summary </span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt; ----------------------</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt; roclearn(X = X_train_lin, y = y_train_lin, lambda = 0.1)</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&gt; Number of observations: 1200 </span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#&gt; Number of predictors: 2 </span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&gt; Penalty: ridge </span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#&gt; Lambda: 0.1 </span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#&gt; Loss function: hinge </span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="co">#&gt; Approximation: Yes (B = 1200 )</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="co">#&gt; Intercept: -0.0678 </span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="co">#&gt; Converged: TRUE </span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="co">#&gt; Iterations: 1179 </span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a><span class="co">#&gt; Training time (sec): 0.05 </span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a><span class="co">#&gt; Coefficients (first 10):</span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a><span class="co">#&gt;        V1        V2 </span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a><span class="co">#&gt; 0.4726011 0.4684517</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a>n_test_lin <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a>n_pos_test_lin <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fl">0.2</span> <span class="sc">*</span> n_test_lin)</span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a>n_neg_test_lin <span class="ot">&lt;-</span> n_test_lin <span class="sc">-</span> n_pos_test_lin</span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a>X_test_lin <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">2</span> <span class="sc">*</span> n_neg_test_lin, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">2</span>),</span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">2</span> <span class="sc">*</span> n_pos_test_lin, <span class="at">mean =</span>  <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a>)</span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a>y_test_lin <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n_neg_test_lin), <span class="fu">rep</span>(<span class="dv">1</span>, n_pos_test_lin))</span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a><span class="co"># Predict decision scores on the test set</span></span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a>pred_score_lin <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_lin, X_test_lin, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a><span class="fu">head</span>(pred_score_lin)</span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a><span class="co">#&gt; [1] -1.7635218 -1.3635854 -0.8779351 -1.4472523 -0.1029838 -1.2500200</span></span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a></span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a><span class="co"># Predict classes {-1, 1} on the test set</span></span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a>pred_class_lin <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_lin, X_test_lin, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb2-55"><a href="#cb2-55" tabindex="-1"></a><span class="fu">head</span>(pred_class_lin)</span>
<span id="cb2-56"><a href="#cb2-56" tabindex="-1"></a><span class="co">#&gt; [1] -1 -1 -1 -1 -1 -1</span></span>
<span id="cb2-57"><a href="#cb2-57" tabindex="-1"></a></span>
<span id="cb2-58"><a href="#cb2-58" tabindex="-1"></a><span class="co"># AUC on the test set</span></span>
<span id="cb2-59"><a href="#cb2-59" tabindex="-1"></a><span class="fu">auc</span>(fit_lin, X_test_lin, y_test_lin)</span>
<span id="cb2-60"><a href="#cb2-60" tabindex="-1"></a><span class="co">#&gt; [1] 0.9763194</span></span>
<span id="cb2-61"><a href="#cb2-61" tabindex="-1"></a></span>
<span id="cb2-62"><a href="#cb2-62" tabindex="-1"></a><span class="co"># Plot ROC curve on the test set</span></span>
<span id="cb2-63"><a href="#cb2-63" tabindex="-1"></a><span class="fu">plot_roc</span>(y_test_lin, pred_score_lin)</span>
<span id="cb2-64"><a href="#cb2-64" tabindex="-1"></a><span class="co">#&gt; Setting levels: control = -1, case = 1</span></span>
<span id="cb2-65"><a href="#cb2-65" tabindex="-1"></a><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span id="cb2-66"><a href="#cb2-66" tabindex="-1"></a><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span id="cb2-67"><a href="#cb2-67" tabindex="-1"></a><span class="co">#&gt; ℹ Please use `linewidth` instead.</span></span>
<span id="cb2-68"><a href="#cb2-68" tabindex="-1"></a><span class="co">#&gt; ℹ The deprecated feature was likely used in the pROC package.</span></span>
<span id="cb2-69"><a href="#cb2-69" tabindex="-1"></a><span class="co">#&gt;   Please report the issue at &lt;https://github.com/xrobin/pROC/issues&gt;.</span></span>
<span id="cb2-70"><a href="#cb2-70" tabindex="-1"></a><span class="co">#&gt; This warning is displayed once every 8 hours.</span></span>
<span id="cb2-71"><a href="#cb2-71" tabindex="-1"></a><span class="co">#&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span>
<span id="cb2-72"><a href="#cb2-72" tabindex="-1"></a><span class="co">#&gt; generated.</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-kernel-model" class="section level1">
<h1>Example: Kernel Model</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>n_ker <span class="ot">&lt;-</span> <span class="dv">1200</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>r_train_ker <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">runif</span>(n_ker, <span class="fl">0.05</span>, <span class="dv">1</span>))</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>theta_train_ker <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_ker, <span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>X_train_ker <span class="ot">&lt;-</span> <span class="fu">cbind</span>(r_train_ker <span class="sc">*</span> <span class="fu">cos</span>(theta_train_ker), r_train_ker <span class="sc">*</span> <span class="fu">sin</span>(theta_train_ker))</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>y_train_ker <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(r_train_ker <span class="sc">&lt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co"># Fit a kernel model</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>fit_ker <span class="ot">&lt;-</span> <span class="fu">kroclearn</span>(X_train_ker, y_train_ker, <span class="at">lambda =</span> <span class="fl">0.1</span>, <span class="at">kernel =</span> <span class="st">&quot;radial&quot;</span>)</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="fu">summary</span>(fit_ker)</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt; Kernel Model Summary </span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt; -----------------------------</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt; kroclearn(X = X_train_ker, y = y_train_ker, lambda = 0.1, kernel = &quot;radial&quot;)</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">#&gt; Number of observations: 1200 </span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co">#&gt; Number of predictors: 2 </span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="co">#&gt; Kernel: radial </span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="co">#&gt; Kernel parameter: 0.5 </span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="co">#&gt; Lambda: 0.1 </span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="co">#&gt; Loss function: hinge </span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="co">#&gt; Approximation: Yes (Nystrom, B = 1200 )</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a><span class="co">#&gt;   Nystrom landmarks: 35 </span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="co">#&gt; Intercept: -1.4187 </span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="co">#&gt; Converged: TRUE </span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a><span class="co">#&gt; Iterations: 1117 </span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a><span class="co">#&gt; Training time (sec): 0.5 </span></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a><span class="co">#&gt; Theta coefficients (first 10):</span></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a><span class="co">#&gt;  [1]  0.07866332 -0.03783574  0.10868490  0.37010068  0.09839754 -0.03419196</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a><span class="co">#&gt;  [7]  0.34827559  0.46628109  0.15124239  1.07986830</span></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a><span class="co">#&gt; ...</span></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a>n_test_ker <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a>r_test_ker <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">runif</span>(n_test_ker, <span class="fl">0.05</span>, <span class="dv">1</span>))</span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a>theta_test_ker <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_test_ker, <span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a>X_test_ker <span class="ot">&lt;-</span> <span class="fu">cbind</span>(r_test_ker <span class="sc">*</span> <span class="fu">cos</span>(theta_test_ker), r_test_ker <span class="sc">*</span> <span class="fu">sin</span>(theta_test_ker))</span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a>y_test_ker <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(r_test_ker <span class="sc">&lt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a><span class="co"># Predict decision scores on the test set</span></span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a>pred_score_ker <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_ker, X_test_ker, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a><span class="fu">head</span>(pred_score_ker)</span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a><span class="co">#&gt; [1]  0.28910462 -0.07075436 -0.17158776 -0.59294103  0.06180517 -0.12245284</span></span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a></span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a><span class="co"># Predict classes {-1, 1} on the test set</span></span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a>pred_class_ker <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_ker, X_test_ker, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a><span class="fu">head</span>(pred_class_ker)</span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a><span class="co">#&gt; [1]  1 -1 -1 -1  1 -1</span></span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a></span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a><span class="co"># AUC on the test set</span></span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a><span class="fu">auc</span>(fit_ker, X_test_ker, y_test_ker)</span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a><span class="co">#&gt; [1] 0.9942396</span></span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a></span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a><span class="co"># Plot ROC curve on the test set</span></span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a><span class="fu">plot_roc</span>(y_test_ker, pred_score_ker)</span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a><span class="co">#&gt; Setting levels: control = -1, case = 1</span></span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a><span class="co">#&gt; Setting direction: controls &lt; cases</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="cross-validation" class="section level1">
<h1>Cross-Validation</h1>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># 5-fold CV for linear models</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>cvfit_lin <span class="ot">&lt;-</span> <span class="fu">cv.roclearn</span>(</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  X_train_lin, y_train_lin,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">lambda.vec =</span> <span class="fu">exp</span>(<span class="fu">seq</span>(<span class="fu">log</span>(<span class="fl">0.01</span>), <span class="fu">log</span>(<span class="dv">5</span>), <span class="at">length.out =</span> <span class="dv">20</span>)),</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">nfolds =</span> <span class="dv">5</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co"># Summarize the cross-validation result</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="fu">summary</span>(cvfit_lin)</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; Cross-validated Linear Model </span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; -----------------------</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; Loss: hinge </span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; Penalty: ridge </span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; Number of folds: 5 </span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; Number of candidate lambdas: 20 </span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; Optimal lambda: 0.05131629 </span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt; Cross-validated AUC at optimal lambda: 0.9694 (+/- 0.0103) </span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt; Overall AUC (mean +/- sd) across lambdas:</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt;    lambda auc.mean auc.sd</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt; 1  0.0100   0.9687 0.0099</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt; 2  0.0139   0.9687 0.0096</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co">#&gt; 3  0.0192   0.9688 0.0095</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co">#&gt; 4  0.0267   0.9690 0.0104</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co">#&gt; 5  0.0370   0.9690 0.0100</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co">#&gt; 6  0.0513   0.9694 0.0103</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="co">#&gt; 7  0.0712   0.9688 0.0106</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="co">#&gt; 8  0.0987   0.9692 0.0104</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="co">#&gt; 9  0.1370   0.9692 0.0102</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="co">#&gt; 10 0.1900   0.9692 0.0103</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="co">#&gt; ...</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Plot the cross-validation AUC across lambda values</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">plot</span>(cvfit_lin)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># 5-fold CV for kernel models</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>cvfit_ker <span class="ot">&lt;-</span> <span class="fu">cv.kroclearn</span>(</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  X_train_ker, y_train_ker,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="at">lambda.vec =</span> <span class="fu">exp</span>(<span class="fu">seq</span>(<span class="fu">log</span>(<span class="fl">0.01</span>), <span class="fu">log</span>(<span class="dv">5</span>), <span class="at">length.out =</span> <span class="dv">20</span>)),</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="st">&quot;radial&quot;</span>,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="at">nfolds =</span> <span class="dv">5</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co"># Summarize the cross-validation result</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="fu">summary</span>(cvfit_ker)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; Cross-validated Kernel Model </span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; ------------------------------</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt; Loss: hinge </span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; Kernel: radial </span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; Number of folds: 5 </span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; Number of candidate lambdas: 20 </span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; Optimal lambda: 0.01386919 </span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; Cross-validated AUC at optimal lambda: 0.9994 (+/- 0.0005) </span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt; Overall AUC (mean +/- sd) across lambdas:</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt;    lambda auc.mean auc.sd</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co">#&gt; 1  0.0100   0.9981 0.0031</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co">#&gt; 2  0.0139   0.9994 0.0005</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="co">#&gt; 3  0.0192   0.9984 0.0025</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="co">#&gt; 4  0.0267   0.9992 0.0012</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="co">#&gt; 5  0.0370   0.9986 0.0018</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="co">#&gt; 6  0.0513   0.9987 0.0016</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="co">#&gt; 7  0.0712   0.9972 0.0017</span></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="co">#&gt; 8  0.0987   0.9947 0.0047</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a><span class="co">#&gt; 9  0.1370   0.9868 0.0136</span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="co">#&gt; 10 0.1900   0.9833 0.0076</span></span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a><span class="co">#&gt; ...</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Plot the cross-validation AUC across lambda values</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">plot</span>(cvfit_ker)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="real-data-example-1-ionosphere" class="section level1">
<h1>Real Data Example 1: Ionosphere</h1>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">library</span>(mlbench)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; Warning: package &#39;mlbench&#39; was built under R version 4.4.3</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">data</span>(Ionosphere)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co"># Prepare data</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>X_iono <span class="ot">&lt;-</span> Ionosphere[, <span class="sc">-</span><span class="dv">35</span>]</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>y_iono <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Ionosphere<span class="sc">$</span>Class <span class="sc">==</span> <span class="st">&quot;bad&quot;</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>train_idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(X_iono)), <span class="at">size =</span> <span class="dv">200</span>)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>X_train_iono <span class="ot">&lt;-</span> X_iono[train_idx, ]</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>y_train_iono <span class="ot">&lt;-</span> y_iono[train_idx]</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>X_test_iono  <span class="ot">&lt;-</span> X_iono[<span class="sc">-</span>train_idx, ]</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>y_test_iono  <span class="ot">&lt;-</span> y_iono[<span class="sc">-</span>train_idx]</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co"># Fit a linear model</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>fit_iono_lin <span class="ot">&lt;-</span> <span class="fu">roclearn</span>(X_train_iono, y_train_iono, <span class="at">lambda =</span> <span class="fl">0.1</span>, <span class="at">approx=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt; Warning: Removing constant columns: V2</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; [V1]: treated as categorical and one-hot encoded.</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="fu">summary</span>(fit_iono_lin)</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt; Linear Model Summary </span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt; ----------------------</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt; roclearn(X = X_train_iono, y = y_train_iono, lambda = 0.1, approx = TRUE)</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="co">#&gt; Number of observations: 200 </span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="co">#&gt; Number of predictors: 33 </span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="co">#&gt; Penalty: ridge </span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="co">#&gt; Lambda: 0.1 </span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="co">#&gt; Loss function: hinge </span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="co">#&gt; Approximation: Yes (B = 200 )</span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a><span class="co">#&gt; Intercept: 1.3041 </span></span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a><span class="co">#&gt; Converged: TRUE </span></span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a><span class="co">#&gt; Iterations: 1164 </span></span>
<span id="cb8-37"><a href="#cb8-37" tabindex="-1"></a><span class="co">#&gt; Training time (sec): 0.07 </span></span>
<span id="cb8-38"><a href="#cb8-38" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-39"><a href="#cb8-39" tabindex="-1"></a><span class="co">#&gt; Coefficients (first 10):</span></span>
<span id="cb8-40"><a href="#cb8-40" tabindex="-1"></a><span class="co">#&gt;          V3          V4          V5          V6          V7          V8 </span></span>
<span id="cb8-41"><a href="#cb8-41" tabindex="-1"></a><span class="co">#&gt; -0.40674510 -0.18973373 -0.42204641 -0.22075386 -0.17022688 -0.43640505 </span></span>
<span id="cb8-42"><a href="#cb8-42" tabindex="-1"></a><span class="co">#&gt;          V9         V10         V11         V12 </span></span>
<span id="cb8-43"><a href="#cb8-43" tabindex="-1"></a><span class="co">#&gt; -0.12857765 -0.24904508  0.08956809 -0.11456464 </span></span>
<span id="cb8-44"><a href="#cb8-44" tabindex="-1"></a><span class="co">#&gt; ...</span></span>
<span id="cb8-45"><a href="#cb8-45" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-46"><a href="#cb8-46" tabindex="-1"></a><span class="co">#&gt; Categorical variables dummy-encoded:</span></span>
<span id="cb8-47"><a href="#cb8-47" tabindex="-1"></a><span class="co">#&gt; [1] &quot;V1&quot;</span></span>
<span id="cb8-48"><a href="#cb8-48" tabindex="-1"></a><span class="co">#&gt; Removed columns:</span></span>
<span id="cb8-49"><a href="#cb8-49" tabindex="-1"></a><span class="co">#&gt; [1] &quot;V2&quot;</span></span>
<span id="cb8-50"><a href="#cb8-50" tabindex="-1"></a></span>
<span id="cb8-51"><a href="#cb8-51" tabindex="-1"></a><span class="co"># Predict decision scores on the test set</span></span>
<span id="cb8-52"><a href="#cb8-52" tabindex="-1"></a>pred_score_iono_lin <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_iono_lin, X_test_iono, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-53"><a href="#cb8-53" tabindex="-1"></a><span class="fu">head</span>(pred_score_iono_lin)</span>
<span id="cb8-54"><a href="#cb8-54" tabindex="-1"></a><span class="co">#&gt; [1]  0.7813989 -0.4333132  1.0361641  1.5973041  0.2972169 -0.4974081</span></span>
<span id="cb8-55"><a href="#cb8-55" tabindex="-1"></a></span>
<span id="cb8-56"><a href="#cb8-56" tabindex="-1"></a><span class="co"># Predict classes {-1, 1} on the test set</span></span>
<span id="cb8-57"><a href="#cb8-57" tabindex="-1"></a>pred_class_iono_lin <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_iono_lin, X_test_iono, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb8-58"><a href="#cb8-58" tabindex="-1"></a><span class="fu">head</span>(pred_class_iono_lin)</span>
<span id="cb8-59"><a href="#cb8-59" tabindex="-1"></a><span class="co">#&gt; [1]  1 -1  1  1  1 -1</span></span>
<span id="cb8-60"><a href="#cb8-60" tabindex="-1"></a></span>
<span id="cb8-61"><a href="#cb8-61" tabindex="-1"></a><span class="co"># AUC on the test set</span></span>
<span id="cb8-62"><a href="#cb8-62" tabindex="-1"></a><span class="fu">auc</span>(fit_iono_lin, X_test_iono, y_test_iono)</span>
<span id="cb8-63"><a href="#cb8-63" tabindex="-1"></a><span class="co">#&gt; [1] 0.9184803</span></span>
<span id="cb8-64"><a href="#cb8-64" tabindex="-1"></a></span>
<span id="cb8-65"><a href="#cb8-65" tabindex="-1"></a><span class="co"># Plot ROC curve on the test set</span></span>
<span id="cb8-66"><a href="#cb8-66" tabindex="-1"></a><span class="fu">plot_roc</span>(y_test_iono, pred_score_iono_lin)</span>
<span id="cb8-67"><a href="#cb8-67" tabindex="-1"></a><span class="co">#&gt; Setting levels: control = -1, case = 1</span></span>
<span id="cb8-68"><a href="#cb8-68" tabindex="-1"></a><span class="co">#&gt; Setting direction: controls &lt; cases</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># 5-fold CV for linear models</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>cvfit_iono_lin <span class="ot">&lt;-</span> <span class="fu">cv.roclearn</span>(</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  X_train_iono, y_train_iono,</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="at">lambda.vec =</span> <span class="fu">exp</span>(<span class="fu">seq</span>(<span class="fu">log</span>(<span class="fl">0.01</span>), <span class="fu">log</span>(<span class="dv">5</span>), <span class="at">length.out =</span> <span class="dv">10</span>)),</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  <span class="at">approx=</span><span class="cn">TRUE</span>, <span class="at">nfolds=</span><span class="dv">5</span>)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; Warning: Removing constant columns: V2</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; [V1]: treated as categorical and one-hot encoded.</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="fu">summary</span>(cvfit_iono_lin)</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; Cross-validated Linear Model </span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; -----------------------</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; Loss: hinge </span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; Penalty: ridge </span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; Number of folds: 5 </span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; Number of candidate lambdas: 10 </span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; Optimal lambda: 0.3158114 </span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; Cross-validated AUC at optimal lambda: 0.8633 (+/- 0.0965) </span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; Overall AUC (mean +/- sd) across lambdas:</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt;    lambda auc.mean auc.sd</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; 1  0.0100   0.8072 0.1232</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt; 2  0.0199   0.8236 0.1222</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt; 3  0.0398   0.8408 0.0943</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt; 4  0.0794   0.8624 0.0794</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt; 5  0.1580   0.8501 0.0866</span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt; 6  0.3160   0.8633 0.0965</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt; 7  0.6300   0.8489 0.0896</span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; 8  1.2600   0.8250 0.1270</span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt; 9  2.5100   0.8068 0.1361</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; 10 5.0000   0.7776 0.1213</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Plot the cross-validation AUC across lambda values</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">plot</span>(cvfit_iono_lin)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Fit a kernel model</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>fit_iono_ker <span class="ot">&lt;-</span> <span class="fu">kroclearn</span>(X_train_iono, y_train_iono, <span class="at">lambda =</span> <span class="fl">0.1</span>, <span class="at">kernel =</span> <span class="st">&quot;radial&quot;</span>, <span class="at">approx=</span><span class="cn">TRUE</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; Warning: Removing constant columns: V2</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; [V1]: treated as categorical and one-hot encoded.</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">summary</span>(fit_iono_ker)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; Kernel Model Summary </span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; -----------------------------</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; kroclearn(X = X_train_iono, y = y_train_iono, lambda = 0.1, kernel = &quot;radial&quot;, </span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt;     approx = TRUE)</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; Number of observations: 200 </span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; Number of predictors: 33 </span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; Kernel: radial </span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt; Kernel parameter: 0.03030303 </span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; Lambda: 0.1 </span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt; Loss function: hinge </span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt; Approximation: Yes (Nystrom, B = 200 )</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt;   Nystrom landmarks: 14 </span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt; Intercept: 0.7425 </span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt; Converged: TRUE </span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt; Iterations: 1276 </span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt; Training time (sec): 0.05 </span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a><span class="co">#&gt; Theta coefficients (first 10):</span></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a><span class="co">#&gt;  [1] -0.87955477  0.22849258 -0.33857814 -0.67966979 -0.04122377 -0.17061431</span></span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="co">#&gt;  [7]  0.08362898 -0.76337429  0.35662077 -0.52693062</span></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="co">#&gt; ...</span></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a><span class="co">#&gt; Categorical variables dummy-encoded:</span></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a><span class="co">#&gt; [1] &quot;V1&quot;</span></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a><span class="co">#&gt; Removed columns:</span></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a><span class="co">#&gt; [1] &quot;V2&quot;</span></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a></span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a><span class="co"># Predict decision scores on the test set</span></span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a>pred_score_iono_ker <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_iono_ker, X_test_iono, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a><span class="fu">head</span>(pred_score_iono_ker)</span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a><span class="co">#&gt; [1]  0.1672607 -0.6231523  0.2522829  0.4332831 -0.2635053 -0.6066902</span></span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a></span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a><span class="co"># Predict classes {-1, 1} on the test set</span></span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a>pred_class_iono_ker <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_iono_ker, X_test_iono, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a><span class="fu">head</span>(pred_class_iono_ker)</span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a><span class="co">#&gt; [1]  1 -1  1  1 -1 -1</span></span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a></span>
<span id="cb11-47"><a href="#cb11-47" tabindex="-1"></a><span class="co"># AUC on the test set</span></span>
<span id="cb11-48"><a href="#cb11-48" tabindex="-1"></a><span class="fu">auc</span>(fit_iono_ker, X_test_iono, y_test_iono)</span>
<span id="cb11-49"><a href="#cb11-49" tabindex="-1"></a><span class="co">#&gt; [1] 0.8999618</span></span>
<span id="cb11-50"><a href="#cb11-50" tabindex="-1"></a></span>
<span id="cb11-51"><a href="#cb11-51" tabindex="-1"></a><span class="co"># Plot ROC curve on the test set</span></span>
<span id="cb11-52"><a href="#cb11-52" tabindex="-1"></a><span class="fu">plot_roc</span>(y_test_iono, pred_score_iono_ker)</span>
<span id="cb11-53"><a href="#cb11-53" tabindex="-1"></a><span class="co">#&gt; Setting levels: control = -1, case = 1</span></span>
<span id="cb11-54"><a href="#cb11-54" tabindex="-1"></a><span class="co">#&gt; Setting direction: controls &lt; cases</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># 5-fold CV for kernel models</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>cvfit_iono_ker <span class="ot">&lt;-</span> <span class="fu">cv.kroclearn</span>(</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  X_train_iono, y_train_iono,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="at">lambda.vec =</span> <span class="fu">exp</span>(<span class="fu">seq</span>(<span class="fu">log</span>(<span class="fl">0.01</span>), <span class="fu">log</span>(<span class="dv">5</span>), <span class="at">length.out =</span> <span class="dv">10</span>)),</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="st">&quot;radial&quot;</span>,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="at">approx=</span><span class="cn">TRUE</span>, <span class="at">nfolds=</span><span class="dv">5</span>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; Warning: Removing constant columns: V2</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; [V1]: treated as categorical and one-hot encoded.</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="fu">summary</span>(cvfit_iono_ker)</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; Cross-validated Kernel Model </span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; ------------------------------</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; Loss: hinge </span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; Kernel: radial </span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt; Number of folds: 5 </span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; Number of candidate lambdas: 10 </span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; Optimal lambda: 0.01994737 </span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt; Cross-validated AUC at optimal lambda: 0.9153 (+/- 0.0226) </span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; Overall AUC (mean +/- sd) across lambdas:</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt;    lambda auc.mean auc.sd</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt; 1  0.0100   0.8981 0.0560</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt; 2  0.0199   0.9153 0.0226</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="co">#&gt; 3  0.0398   0.8671 0.0773</span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a><span class="co">#&gt; 4  0.0794   0.8608 0.0530</span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co">#&gt; 5  0.1580   0.8189 0.0580</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a><span class="co">#&gt; 6  0.3160   0.8189 0.0665</span></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a><span class="co">#&gt; 7  0.6300   0.7965 0.0450</span></span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a><span class="co">#&gt; 8  1.2600   0.7944 0.0879</span></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a><span class="co">#&gt; 9  2.5100   0.8041 0.0649</span></span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a><span class="co">#&gt; 10 5.0000   0.8137 0.0387</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Plot the cross-validation AUC across lambda values</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">plot</span>(cvfit_iono_ker)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="real-data-example-2-spam-larger-dataset" class="section level1">
<h1>Real Data Example 2: Spam (larger dataset)</h1>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">library</span>(kernlab)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">data</span>(spam)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co"># Prepare data</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>X_spam <span class="ot">&lt;-</span> spam[, <span class="sc">-</span><span class="dv">58</span>]</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>y_spam <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(spam<span class="sc">$</span>type <span class="sc">==</span> <span class="st">&quot;spam&quot;</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>train_idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(X_spam)), <span class="at">size =</span> <span class="dv">3000</span>)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>X_train_spam <span class="ot">&lt;-</span> X_spam[train_idx, ]</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>y_train_spam <span class="ot">&lt;-</span> y_spam[train_idx]</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>X_test_spam  <span class="ot">&lt;-</span> X_spam[<span class="sc">-</span>train_idx, ]</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>y_test_spam  <span class="ot">&lt;-</span> y_spam[<span class="sc">-</span>train_idx]</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co"># Fit a linear model</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>fit_spam_lin <span class="ot">&lt;-</span> <span class="fu">roclearn</span>(X_train_spam, y_train_spam, <span class="at">lambda =</span> <span class="fl">0.1</span>)</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="fu">summary</span>(fit_spam_lin)</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt; Linear Model Summary </span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt; ----------------------</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt; roclearn(X = X_train_spam, y = y_train_spam, lambda = 0.1)</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt; Number of observations: 3000 </span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co">#&gt; Number of predictors: 57 </span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co">#&gt; Penalty: ridge </span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co">#&gt; Lambda: 0.1 </span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="co">#&gt; Loss function: hinge </span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="co">#&gt; Approximation: Yes (B = 3000 )</span></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a><span class="co">#&gt; Intercept: -0.5147 </span></span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a><span class="co">#&gt; Converged: TRUE </span></span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a><span class="co">#&gt; Iterations: 10 </span></span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a><span class="co">#&gt; Training time (sec): 0.02 </span></span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a><span class="co">#&gt; Coefficients (first 10):</span></span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a><span class="co">#&gt;          make       address           all         num3d           our </span></span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a><span class="co">#&gt;  4.321339e-06 -5.145267e-06  1.017238e-05  5.731498e-06  1.621501e-05 </span></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a><span class="co">#&gt;          over        remove      internet         order          mail </span></span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a><span class="co">#&gt;  5.582747e-06  1.344279e-05  7.710516e-06  3.596203e-06  7.202070e-06 </span></span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a><span class="co">#&gt; ...</span></span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a></span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a><span class="co"># Predict decision scores on the test set</span></span>
<span id="cb14-44"><a href="#cb14-44" tabindex="-1"></a>pred_score_spam_lin <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_spam_lin, X_test_spam, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb14-45"><a href="#cb14-45" tabindex="-1"></a><span class="fu">head</span>(pred_score_spam_lin)</span>
<span id="cb14-46"><a href="#cb14-46" tabindex="-1"></a><span class="co">#&gt;          3          6          8         10         14         15 </span></span>
<span id="cb14-47"><a href="#cb14-47" tabindex="-1"></a><span class="co">#&gt; 10.4085857 -0.2464476 -0.2763554  2.8799679 -0.3900616  0.4386678</span></span>
<span id="cb14-48"><a href="#cb14-48" tabindex="-1"></a></span>
<span id="cb14-49"><a href="#cb14-49" tabindex="-1"></a><span class="co"># Predict classes {-1, 1} on the test set</span></span>
<span id="cb14-50"><a href="#cb14-50" tabindex="-1"></a>pred_class_spam_lin <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_spam_lin, X_test_spam, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb14-51"><a href="#cb14-51" tabindex="-1"></a><span class="fu">head</span>(pred_class_spam_lin)</span>
<span id="cb14-52"><a href="#cb14-52" tabindex="-1"></a><span class="co">#&gt;  3  6  8 10 14 15 </span></span>
<span id="cb14-53"><a href="#cb14-53" tabindex="-1"></a><span class="co">#&gt;  1 -1 -1  1 -1  1</span></span>
<span id="cb14-54"><a href="#cb14-54" tabindex="-1"></a></span>
<span id="cb14-55"><a href="#cb14-55" tabindex="-1"></a><span class="co"># AUC on the test set</span></span>
<span id="cb14-56"><a href="#cb14-56" tabindex="-1"></a><span class="fu">auc</span>(fit_spam_lin, X_test_spam, y_test_spam)</span>
<span id="cb14-57"><a href="#cb14-57" tabindex="-1"></a><span class="co">#&gt; [1] 0.7624179</span></span>
<span id="cb14-58"><a href="#cb14-58" tabindex="-1"></a></span>
<span id="cb14-59"><a href="#cb14-59" tabindex="-1"></a><span class="co"># Plot ROC curve on the test set</span></span>
<span id="cb14-60"><a href="#cb14-60" tabindex="-1"></a><span class="fu">plot_roc</span>(y_test_spam, pred_score_spam_lin)</span>
<span id="cb14-61"><a href="#cb14-61" tabindex="-1"></a><span class="co">#&gt; Setting levels: control = -1, case = 1</span></span>
<span id="cb14-62"><a href="#cb14-62" tabindex="-1"></a><span class="co">#&gt; Setting direction: controls &lt; cases</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># 5-fold CV for linear models </span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>cvfit_spam_lin <span class="ot">&lt;-</span> <span class="fu">cv.roclearn</span>(</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  X_train_spam, y_train_spam,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="at">lambda.vec =</span> <span class="fu">exp</span>(<span class="fu">seq</span>(<span class="fu">log</span>(<span class="fl">0.01</span>), <span class="fu">log</span>(<span class="dv">5</span>), <span class="at">length.out =</span> <span class="dv">10</span>)), <span class="at">nfolds=</span><span class="dv">5</span>)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="fu">summary</span>(cvfit_spam_lin)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; Cross-validated Linear Model </span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; -----------------------</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; Loss: hinge </span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; Penalty: ridge </span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; Number of folds: 5 </span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; Number of candidate lambdas: 10 </span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; Optimal lambda: 0.3158114 </span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; Cross-validated AUC at optimal lambda: 0.7777 (+/- 0.0232) </span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; Overall AUC (mean +/- sd) across lambdas:</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt;    lambda auc.mean auc.sd</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; 1  0.0100   0.7715 0.0167</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; 2  0.0199   0.7764 0.0194</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; 3  0.0398   0.7741 0.0215</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; 4  0.0794   0.7748 0.0220</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; 5  0.1580   0.7758 0.0252</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; 6  0.3160   0.7777 0.0232</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt; 7  0.6300   0.7735 0.0233</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co">#&gt; 8  1.2600   0.7753 0.0192</span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="co">#&gt; 9  2.5100   0.7715 0.0199</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a><span class="co">#&gt; 10 5.0000   0.7722 0.0224</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Plot the cross-validation AUC across lambda values</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">plot</span>(cvfit_spam_lin)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Fit a kernel model</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>fit_spam_ker <span class="ot">&lt;-</span> <span class="fu">kroclearn</span>(X_train_spam, y_train_spam, <span class="at">lambda =</span> <span class="fl">0.1</span>, <span class="at">kernel =</span> <span class="st">&quot;radial&quot;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="fu">summary</span>(fit_spam_ker)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt; Kernel Model Summary </span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt; -----------------------------</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#&gt; kroclearn(X = X_train_spam, y = y_train_spam, lambda = 0.1, kernel = &quot;radial&quot;)</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#&gt; Number of observations: 3000 </span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt; Number of predictors: 57 </span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt; Kernel: radial </span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt; Kernel parameter: 0.01754386 </span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt; Lambda: 0.1 </span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co">#&gt; Loss function: hinge </span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co">#&gt; Approximation: Yes (Nystrom, B = 3000 )</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co">#&gt;   Nystrom landmarks: 55 </span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co">#&gt; Intercept: 5e-04 </span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co">#&gt; Converged: TRUE </span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="co">#&gt; Iterations: 607 </span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#&gt; Training time (sec): 0.74 </span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="co">#&gt; Theta coefficients (first 10):</span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="co">#&gt;  [1] -0.106694761  0.034588410 -0.155193553 -0.091769201  0.008358426</span></span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a><span class="co">#&gt;  [6]  0.039672217 -0.191470994 -0.079506402  0.013024674 -0.468039804</span></span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a><span class="co">#&gt; ...</span></span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a><span class="co"># Predict decision scores on the test set</span></span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a>pred_score_spam_ker <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_spam_ker, X_test_spam, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a><span class="fu">head</span>(pred_score_spam_ker)</span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a><span class="co">#&gt;             3             6             8            10            14 </span></span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a><span class="co">#&gt;  0.0005386429 -0.0461043933 -0.1537764925  0.0005388521 -0.3817359714 </span></span>
<span id="cb17-34"><a href="#cb17-34" tabindex="-1"></a><span class="co">#&gt;            15 </span></span>
<span id="cb17-35"><a href="#cb17-35" tabindex="-1"></a><span class="co">#&gt;  0.0005386429</span></span>
<span id="cb17-36"><a href="#cb17-36" tabindex="-1"></a></span>
<span id="cb17-37"><a href="#cb17-37" tabindex="-1"></a><span class="co"># Predict classes {-1, 1} on the test set</span></span>
<span id="cb17-38"><a href="#cb17-38" tabindex="-1"></a>pred_class_spam_ker <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_spam_ker, X_test_spam, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb17-39"><a href="#cb17-39" tabindex="-1"></a><span class="fu">head</span>(pred_class_spam_ker)</span>
<span id="cb17-40"><a href="#cb17-40" tabindex="-1"></a><span class="co">#&gt;  3  6  8 10 14 15 </span></span>
<span id="cb17-41"><a href="#cb17-41" tabindex="-1"></a><span class="co">#&gt;  1 -1 -1  1 -1  1</span></span>
<span id="cb17-42"><a href="#cb17-42" tabindex="-1"></a></span>
<span id="cb17-43"><a href="#cb17-43" tabindex="-1"></a><span class="co"># AUC on the test set</span></span>
<span id="cb17-44"><a href="#cb17-44" tabindex="-1"></a><span class="fu">auc</span>(fit_spam_ker, X_test_spam, y_test_spam)</span>
<span id="cb17-45"><a href="#cb17-45" tabindex="-1"></a><span class="co">#&gt; [1] 0.7513072</span></span>
<span id="cb17-46"><a href="#cb17-46" tabindex="-1"></a></span>
<span id="cb17-47"><a href="#cb17-47" tabindex="-1"></a><span class="co"># Plot ROC curve on the test set</span></span>
<span id="cb17-48"><a href="#cb17-48" tabindex="-1"></a><span class="fu">plot_roc</span>(y_test_spam, pred_score_spam_ker)</span>
<span id="cb17-49"><a href="#cb17-49" tabindex="-1"></a><span class="co">#&gt; Setting levels: control = -1, case = 1</span></span>
<span id="cb17-50"><a href="#cb17-50" tabindex="-1"></a><span class="co">#&gt; Setting direction: controls &lt; cases</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># 5-fold CV for kernel models </span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>cvfit_spam_ker <span class="ot">&lt;-</span> <span class="fu">cv.kroclearn</span>(</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  X_train_spam, y_train_spam,</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="st">&quot;radial&quot;</span>, </span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  <span class="at">lambda.vec =</span> <span class="fu">exp</span>(<span class="fu">seq</span>(<span class="fu">log</span>(<span class="fl">0.01</span>), <span class="fu">log</span>(<span class="dv">5</span>), <span class="at">length.out =</span> <span class="dv">10</span>)), <span class="at">nfolds=</span><span class="dv">5</span>)</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="fu">summary</span>(cvfit_spam_ker)</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt; Cross-validated Kernel Model </span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; ------------------------------</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; Loss: hinge </span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt; Kernel: radial </span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt; Number of folds: 5 </span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt; Number of candidate lambdas: 10 </span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt; Optimal lambda: 5 </span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; Cross-validated AUC at optimal lambda: 0.7385 (+/- 0.0146) </span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co">#&gt; Overall AUC (mean +/- sd) across lambdas:</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#&gt;    lambda auc.mean auc.sd</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="co">#&gt; 1  0.0100   0.7303 0.0146</span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="co">#&gt; 2  0.0199   0.7173 0.0339</span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="co">#&gt; 3  0.0398   0.7301 0.0139</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="co">#&gt; 4  0.0794   0.7287 0.0167</span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a><span class="co">#&gt; 5  0.1580   0.7258 0.0184</span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="co">#&gt; 6  0.3160   0.7196 0.0162</span></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a><span class="co">#&gt; 7  0.6300   0.7281 0.0295</span></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a><span class="co">#&gt; 8  1.2600   0.7331 0.0168</span></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a><span class="co">#&gt; 9  2.5100   0.7259 0.0292</span></span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a><span class="co">#&gt; 10 5.0000   0.7385 0.0146</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Plot the cross-validation AUC across lambda values</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">plot</span>(cvfit_spam_ker)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p>The <strong>roclab</strong> package implements ROC-Optimizing Binary
Classifiers through both <strong>linear models</strong> (with
regularization penalties) and <strong>kernel models</strong> (with
various kernel functions). It supports multiple surrogate loss functions
and incorporates scalable options to efficiently handle large
datasets.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
